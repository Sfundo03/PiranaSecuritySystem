@model PiranaSecuritySystem.Models.Instructor

@{
    ViewBag.Title = "Instructor Dashboard";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <!-- Welcome Message -->
            <div class="alert alert-info">
                <h4><i class="fas fa-chalkboard-teacher"></i> Welcome, @Model.FullName!</h4>
                <p>You have successfully logged in to the Pirana Security System instructor portal.</p>
            </div>

            @if (TempData["SuccessMessage"] != null)
            {
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i> @TempData["SuccessMessage"]
                </div>
            }

            @if (TempData["ErrorMessage"] != null)
            {
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle"></i> @TempData["ErrorMessage"]
                </div>
            }

            <div class="row">
                <!-- Instructor Details Card -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5><i class="fas fa-user-tie"></i> My Instructor Profile</h5>
                        </div>
                        <div class="card-body">
                            <table class="table table-borderless">
                                <tr>
                                    <th style="width: 40%">Employee ID:</th>
                                    <td>@Model.EmployeeId</td>
                                </tr>
                                <tr>
                                    <th>Full Name:</th>
                                    <td>@Model.FullName</td>
                                </tr>
                                <tr>
                                    <th>Email:</th>
                                    <td>@Model.Email</td>
                                </tr>
                                <tr>
                                    <th>Phone:</th>
                                    <td>@Model.PhoneNumber</td>
                                </tr>
                                <tr>
                                    <th>Specialization:</th>
                                    <td>
                                        <span class="badge badge-info">@Model.Specialization</span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Status:</th>
                                    <td>
                                        @if (Model.IsActive)
                                        {
                                            <span class="badge badge-success">Active</span>
                                        }
                                        else
                                        {
                                            <span class="badge badge-danger">Inactive</span>
                                        }
                                    </td>
                                </tr>
                                <tr>
                                    <th>Date Registered:</th>
                                    <td>@Model.DateRegistered.ToString("MMM dd, yyyy")</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Training Actions Card -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-success text-white">
                            <h5><i class="fas fa-tasks"></i> Training Management</h5>
                        </div>
                        <div class="card-body">
                            <!-- Generate Shifts Button -->
                            <a href="@Url.Action("Create", "Shifts")" class="btn btn-primary btn-lg btn-block mb-3">
                                <i class="fas fa-calendar-plus"></i> Generate Shifts
                            </a>

                            <!-- View My Shifts -->
                            <a href="@Url.Action("Index", "Shifts")" class="btn btn-info btn-lg btn-block mb-3">
                                <i class="fas fa-calendar-alt"></i> View My Shifts
                            </a>

                            <!-- Create Training Session -->
                            <button class="btn btn-success btn-lg btn-block mb-3" data-toggle="modal" data-target="#trainingModal">
                                <i class="fas fa-plus-circle"></i> Create Training Session
                            </button>

                            <!-- Training Materials -->
                            <button class="btn btn-warning btn-lg btn-block mb-3" data-toggle="modal" data-target="#materialsModal">
                                <i class="fas fa-book"></i> Training Materials
                            </button>

                            <!-- Assessment Results -->
                            <a href="#" class="btn btn-secondary btn-lg btn-block">
                                <i class="fas fa-chart-bar"></i> Assessment Results
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Training Statistics -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-chart-line"></i> Training Overview</h5>
                        </div>
                        <div class="card-body">
                            <div class="row text-center">
                                <div class="col-md-3">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <i class="fas fa-users fa-2x text-primary mb-2"></i>
                                            <h6>Total Trainees</h6>
                                            <h3 id="totalTrainees">Loading...</h3>
                                            <small class="text-muted">This month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <i class="fas fa-calendar-check fa-2x text-success mb-2"></i>
                                            <h6>Sessions Completed</h6>
                                            <h3 id="sessionsCompleted">Loading...</h3>
                                            <small class="text-muted">This month</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <i class="fas fa-graduation-cap fa-2x text-info mb-2"></i>
                                            <h6>Certifications</h6>
                                            <h3 id="certificationsIssued">Loading...</h3>
                                            <small class="text-muted">Issued</small>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <i class="fas fa-star fa-2x text-warning mb-2"></i>
                                            <h6>Average Rating</h6>
                                            <h3 id="averageRating">Loading...</h3>
                                            <small class="text-muted">From feedback</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Upcoming Training Sessions -->
            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5><i class="fas fa-clock"></i> Upcoming Training Sessions</h5>
                        </div>
                        <div class="card-body">
                            <div id="upcomingSessionsPlaceholder">
                                <p class="text-center text-muted py-4">
                                    <i class="fas fa-spinner fa-spin"></i> Loading upcoming sessions...
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Training Session Modal -->
<div class="modal fade" id="trainingModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header bg-success text-white">
                <h5 class="modal-title">Create New Training Session</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label>Course Name</label>
                        <input type="text" class="form-control" placeholder="Enter course name">
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Date</label>
                                <input type="date" class="form-control">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label>Time</label>
                                <input type="time" class="form-control">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Location</label>
                        <select class="form-control">
                            <option>Training Room A</option>
                            <option>Training Room B</option>
                            <option>Medical Lab</option>
                            <option>Training Ground</option>
                            <option>Observation Room</option>
                            <option>Simulation Room</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Maximum Participants</label>
                        <input type="number" class="form-control" placeholder="Number of participants">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-success">Create Session</button>
            </div>
        </div>
    </div>
</div>

<!-- Training Materials Modal -->
<div class="modal fade" id="materialsModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title">Training Materials</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="list-group">
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-pdf text-danger"></i> Firearm Safety Manual.pdf
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-powerpoint text-warning"></i> First Aid Presentation.pptx
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-video text-primary"></i> Defensive Tactics Demo.mp4
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-word text-info"></i> Surveillance Techniques Guide.docx
                    </a>
                    <a href="#" class="list-group-item list-group-item-action">
                        <i class="fas fa-file-excel text-success"></i> Assessment Results.xlsx
                    </a>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-warning">Upload New Material</button>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
        $(document).ready(function () {
            // Auto-dismiss alerts after 5 seconds
            setTimeout(function () {
                $('.alert').fadeOut('slow');
            }, 5000);

            // Placeholder for data loading functions
            // These would be replaced with actual API calls to your backend

            // Example structure for loading training statistics
            /*
            function loadTrainingStatistics() {
                $.get('/Instructor/GetTrainingStats', function(data) {
                    $('#totalTrainees').text(data.totalTrainees);
                    $('#sessionsCompleted').text(data.sessionsCompleted);
                    $('#certificationsIssued').text(data.certificationsIssued);
                    $('#averageRating').text(data.averageRating);
                });
            }
            */

            // Example structure for loading upcoming sessions
            /*
            function loadUpcomingSessions() {
                $.get('/Instructor/GetUpcomingSessions', function(data) {
                    let html = '<div class="table-responsive"><table class="table table-hover">';
                    html += '<thead class="thead-light"><tr><th>Date</th><th>Time</th><th>Course</th><th>Location</th><th>Participants</th><th>Status</th></tr></thead>';
                    html += '<tbody>';

                    // Loop through sessions and build rows
                    data.forEach(function(session) {
                        html += `<tr>
                            <td>${session.date}</td>
                            <td>${session.time}</td>
                            <td>${session.course}</td>
                            <td>${session.location}</td>
                            <td>${session.participants}</td>
                            <td><span class="badge badge-${session.statusClass}">${session.status}</span></td>
                        </tr>`;
                    });

                    html += '</tbody></table></div>';
                    $('#upcomingSessionsPlaceholder').html(html);
                });
            }

            // Call the functions to load data
            loadTrainingStatistics();
            loadUpcomingSessions();
            */
        });
    </script>
}